{% extends 'app1/base.html' %}
{% block body %}
{% load static %}
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>

<script>

    $(document).on('click', '.remove_row', function () {
        var row_id = $(this).attr("id");
        $('#addr0' + row_id + '').remove();

    });

    //   function ShowHideTax(inclusive) {
    //         var inter = document.getElementById("intrastateFiled");

    //         inter.style.display = inclusive.checked ? "block" : "none";

    //     }

    function validateHSNNewitem() {
        var hsnField = document.getElementById("hsn");
        var errorText = document.getElementById("errorText");
        var hsnValue = hsnField.value;

        // Check if the HSN value has more than 6 digits
        if (isNaN(hsnValue) || hsnValue.length !== 6) {
            errorText.innerText = "HSN must be exactly 6 digits ";
            hsnField.style.borderColor = "red";
        } else {
            errorText.innerText = "";
            hsnField.style.borderColor = ""; // Reset border color
        }
    }
</script>
<script>
    $(document).on("click", "#saveNewUnit", function () {
        var unitsymbol = $("#unitsymbol").val();
        var unitname = $("#unitname").val();
        if (unitname != "" && unitsymbol != "") {
            $.ajax({
                type: 'POST',
                url: "{% url 'createitemunit_ewbill' %}",
                data: {
                    uname: unitname,
                    usymbol: unitsymbol,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },

                success: function (response) {
                    console.log("AJAX Success - Response Data:", response);
                    document.getElementById("newunitform").reset();
                    $('#newUnitAddModal').modal('toggle');
                    $('#newitem').modal('toggle');
                    reloadItemUnit();

                    if (response.message == "success") {
                        // alert('unit added')
                    } else {
                        alert('Something went wrong..!')
                    }
                },
            });
        }
        else {
            alert('Invalid')
        }
    });

    function reloadItemUnit() {

        $.ajax({
            url: "{% url 'getitemunitewbill' %}",
            type: "GET",
            dataType: "json",
            data: $(this).serialize(),
            csrfmiddlewaretoken: '{{ csrf_token }}',

            success: function (data) {
                console.log("AJAX Success - Dropdown Data:", data);

                var dropdown = $('#itemunit');
                dropdown.empty()
                dropdown.append(`<option selected disabled value="">Choose...</option>`,
                    `<option>BAG-BAGS</option>`,
                    `<option>BDL-BUNDLES</option>`,
                    `<option>BKL-BUCKLES</option>`,
                    `<option>BOX-BOX</option>`,
                    `<option>BOU-BILLIONS OF UNITS</option>`,
                    `<option>BTL-BOTTLES</option>`,
                    `<option>BUN-BUNCHES</option>`,
                    `<option>CAN-CANS</option>`,
                    `<option>CBM-CUBIC METER</option>`,
                    `<option>CMS-CENTIMETER</option>`,
                    `<option>CCM-CUBIC CENTIMETER</option>`,
                    `<option>CTN-CARTONS</option>`,
                    `<option>DOZ-DOZEN</option>`,
                    `<option>DRM-DRUM</option>`,
                    `<option>GGR-GREAT GROSS</option>`,
                    `<option>GMS-GRAMS</option>`,
                    `<option>GRS-GROSS</option>`,
                    `<option>GYD-GROSS YARDS</option>`,
                    `<option>KGS-KILOGRAMS</option>`,
                    `<option>KLR-KILOLITER</option>`,
                    `<option>KME-KILOMETRE</option>`,
                    `<option>MTS Metric ton</option>`,
                    `<option>MLT-MILLILITRE</option>`,
                    `<option>MTR-METERS</option>`,
                    `<option>NOS-NUMBER</option>`,
                    `<option>PAC-PACKS</option>`,
                    `<option>PCS-PIECES</option>`,
                    `<option>PRS-PAIRS</option>`,
                    `<option>QTL-QUINTAL</option>`,
                    `<option>ROL-ROLLS</option>`,
                    `<option>SQF-SQUARE FEET</option>`,
                    `<option>SET-SETS</option>`,
                    `<option>SQM-SQUARE METERS</option>`,
                    `<option>SQY-SQUARE YARDS</option>`,
                    `<option>TBS-TABLETS</option>`,
                    `<option>TGM-TEN GROSS</option>`,
                    `<option>THD-THOUSANDS</option>`,
                    `<option>TON-TONNES</option>`,
                    `<option>TUB-TUBES</option>`,
                    `<option>UGS-US GALLONS</option>`,
                    `<option>UNT-UNITS</option>`,
                    `<option>YDS-YARDS</option>`);
                $.each(data, function (key, value) {
                    for (let i = 0; i < value.length; i++) {
                        dropdown.append($('<option></option>').attr('value', key).text(value[i].symbol + "-" + value[i].name).val(value[i].symbol + "-" + value[i].name))
                    }
                    console.log('Units reloaded..');
                });
            },
            error: function (xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    }


    $(document).on("click", "#itemSave", function () {
        var taxref, status1;

        if ($('#inclusive').checked) {
            tax = $('#inclusive').val();
        }
        else if ($('#check').val()) {
            tax = $('#check').val();
        }
        else {
            console.log("Checkbox is not checked.");
        }

        console.log(tax);
        if ($('input[name="status"]:checked').val() == 'Active') {

            status1 = $('#flexRadioDefault1').val();
        }
        else {
            status1 = $('#flexRadioDefault2').val();
        }

        $.ajax({

            type: 'POST',
            url: "{% url 'createitem_ewbill' %}",

            data: {
                type: $("#type").val(),
                name: $("#item_name").val(),
                unit: $("#itemunit").val(),
                hsn: $("#hsn").val(),
                taxref: tax,
                salesprice: $("#saleprice").val(),
                pcost: $("#purprice").val(),
                sale_account: $("#sale_account").val(),
                pur_account: $("#pur_account").val(),
                sale_desc: $("#sale_desc").val(),
                pur_desc: $("#pur_desc").val(),
                intra_st: $("#intra_st").val(),
                inter_st: $("#inter_st").val(),
                invacc: $("#invacc").val(),
                stock: $("#stock").val(),
                stock_rate: $("#stock_rate").val(),
                // itmdate : $("#date3").val(),
                status: status1,
                csrfmiddlewaretoken: $("input[name = csrfmiddlewaretoken]").val(),

            },

            success: function (response) {
                console.log(response)
                document.getElementById("modalItem").reset();
                $('#newitem').modal('toggle');
                reloadItem();
            },
        });
    });


    function reloadItem() {
        $.ajax({
            url: "{% url 'item_dropdown_rbill' %}",
            type: "GET",
            dataType: "json",
            data: $(this).serialize(),
            csrfmiddlewaretoken: '{{ csrf_token }}',

            success: function (data) {
                for (var x = 1; x <= RowCount; x++) {

                    var dropdown = $(`.itm${x}`);
                    $.each(data, function (key, value) {
                        if (dropdown.find('option[value="' + key + '"]').length === 0) {
                            // If it doesn't exist, create a new option element
                            var option = $('<option></option>').attr('value', key).text(value).addClass('dropdown-item').attr('id', `dd-item${x}`);
                            dropdown.append(option);
                        }
                    });
                }

            },
            error: function (xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    }



</script>




<script>
    var RowCount = '{{estitem_count}}';
    console.log(RowCount);
    $(document).ready(function () {
        $('#add-row').click(function () {
            var table = document.getElementById("item_table");
            RowCount++;
            console.log(RowCount);
            var newRow = $(`
            <tr>  
                <td>${RowCount}</td>   

                <td style="width: 18%;" class='text-right'>
                    <div class='form-group mt-3 d-flex align-items-center'>
                        <input type="text" id="itemsearchInput${RowCount}"
                            placeholder="Search..." class="dropdown-toggle form-control "
                            autocomplete="off" data-toggle="dropdown"
                            onclick="itemfunction(this.id)">
                        <input type="text" name="item[]" id="item${RowCount}"
                            style="display: none;">
                        <div class="dropdown-menu itm${RowCount}"
                            style="background-color: #000; width: 17%;border-radius: 4px;">
                            {% for i in item %}
                            <option class="dropdown-item" id="dd-item${RowCount}"
                                value="{{ i.id }}">
                                {{i.name }}
                            </option>
                            {% endfor %}
                        </div>
                    </div>
                </td>

                <td class='text-right '>
                    <div>
                        <input type='text' id='hsn${RowCount}'
                            class='form-control  border-0 text-black text-right hsn'
                            name='hsn[]' onchange="validateHSN(this)">
                    </div>
                </td>                                           

                <td class='text-right' style="position: relative;"><input type='number'
                    id='qty${RowCount}'
                    class='form-control border-0 text-black text-right qty' 
                    name='quantity[]' value='0' onchange="calc()">
                </td>

                <td class='text-right'><input type='number' id='rate${RowCount}'
                    class='form-control border-0 text-black text-right rate' name='rate[]'
                    value='0.00' onclick="calc()">
                </td>

                <input type='hidden' id='desc${RowCount}' 
                    class='form-control border-0 text-black text-right desc' name='desc[]' 
                    onclick="calc()">

                <td style="width:10%;">
                    <input type="number" name='discount[]' value='0' id="discount${RowCount}" 
                    class="form-control discount" onclick="calc()"/>
                </td>

                <td style="width:13%" class='text-right'> <select name='tax[]'
                        id='tax${RowCount}'
                        class="form-control  text-black text-right border-0 tax"
                        onselect="calc()" onclick="state(this)">
                        <optgroup label="GST" style="background-color: black;" class="text-center">
                            <option value="0">GST 0%</option>
                            <option value="3">GST 3%</option>
                            <option value="5">GST 5%</option>
                            <option value="12">GST 12%</option>
                            <option value="18">GST 18%</option>
                            <option value="28">GST 28%</option>
                        </optgroup>
                        <optgroup label="IGST" style="background-color: black;" class="text-center">
                            <option value="0">IGST 0%</option>
                            <option value="3">IGST 3%</option>
                            <option value="5">IGST 5%</option>
                            <option value="12">IGST 12%</option>
                            <option value="18" >IGST 18%</option>
                            <option value="28">GST 28%</option>
                        </optgroup>   
                    </select>
                </td>

                <td style="display: none;">
                    <input type="text" name='taxamount' id="taxamount${RowCount}"
                        class="form-control taxamount" />
                </td>

                <td class='text-right'><input type='number' id='amount${RowCount}'
                        class='form-control border-0 text-black text-right amount'
                        name='amount[]' value='0.00'>
                </td>

                <td class='text-center'><button type='button' id='del_btn${RowCount}'
                        class='btn btn-transparent mb-1 text-danger btn-sm btn-outline-danger remove_row rounded-circle delete-row'
                        style='width:30px'>--</button>
                      
                </td>
            </tr>`);

            $(document).on("input", ".hsn", function () {
                var hsn_value = $(this).val();
                var hsn_length = hsn_value.length;
                if (hsn_length > 6) {
                    $(this).val(hsn_value.substring(0, 6));
                    alert("HSN should not be more than 6 digits!");
                }
            });
            $('#item_table').append(newRow);
            reloadItem();
        });

        $('#item_table').on('click', '.delete-row', function () {
            $(this).closest('tr').remove();
            calc();
            test(taxamount);
        });

    });



</script>




<style>
    input {
        background-color: #2f516f;
        border: 0;
        border-radius: 5px;
        color: white;
    }

    input:read-only {
        /* background-color: rgba(0,0,0,.4) !important; */
        background-color: rgb(255 255 255 / 14%) !important;
        color: #fff;
    }
</style>
<form action="{% url 'edited_challan' ch.id %}" method="post" class="needs-validation" enctype="multipart/form-data"
    novalidate>
    {% csrf_token %}
    <div class="page-content">
        <!--breadcrumb-->
        <div class="card radius-15">
            <div class="card-body">.
                <div class="card-title">
                    <center>
                        <h3 class="mb-0" id="invnumb">Edit Delivery Challan</h3>
                    </center>
                </div>
                <hr />
            </div>
        </div>
        <div class="card radius-15">
            <div class="card-body">
                <div id="invoice">

                    <div class="row">
                        <div class="col">
                            <center>
                                <!-- <h2>Fin sYs</h2> -->
                            </center>
                        </div>
                    </div>
                    <!-- <div class="company-details mb-4">
            <h5 class="text-info">{{ cmp1.cname }}</h5>
            <h5 class="text-info">{{ cmp1.cemail }}</h5>
          </div> -->
                    <!-- <div class="row">
            <div class="col-md-3 mt-3">
              <label class="col-form-label">Select Customer</label>
              <div class="">
                <select name="customername" id="select" class="form-control" style="background-color: #2f516f; color: white;" onclick="calc()">
                  <option value="{{ch.customer..customerid}}"  selected>{{ch.customer.firstname}} {{ ch.customer.lastname }}</option>
                  
                </select>
               
              </div>
            </div>

 -->

                    <div class="row">
                        <div class="col">
                            <center>
                                <!-- <h2>Fin sYs</h2> -->
                            </center>
                        </div>
                    </div>
                    <!-- <div class="company-details mb-4">
                <h5 class="text-info">{{ cmp1.cname }}</h5>
                <h5 class="text-info">{{ cmp1.cemail }}</h5>
              </div> -->
                    <div class="row">
                        <div class="col-md-5 mt-3 mr-4 ml-4">

                            <label class="col-form-label">Select Customer</label>
                            <div class="d-flex">
                                <input type="text" id="searchInput" placeholder="Search..."
                                    class="dropdown-toggle form-control " autocomplete="off" data-toggle="dropdown"
                                    onselect="itemfunction()"
                                    value="{{ch.customer.firstname}} {{ ch.customer.lastname }}">
                                <input type="text" name="customerid" id="customerid" style="display: none;"
                                    value="{{ch.customer.customerid}}">
                                <div class="dropdown-menu"
                                    style="background-color: #000; width: 80%;border-radius: 4px;">
                                    {% for cust in customers %}
                                    <option class="dropdown-item" id="d-item" value="{{cust.customerid}}">
                                        {{cust.firstname }} {{ cust.lastname }}</option>
                                    {% endfor %}
                                </div>
                                <a>
                                    <button type="button" data-toggle="modal" data-target="#newcust"
                                        class="btn btn-outline-secondary ml-1">+</button>
                                </a>
                                <script>
                                    $searchrows = $('.dropdown-menu #d-item');
                                    $('#searchInput').keyup(function () {
                                        var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
                                        $searchrows.show().filter(function () {
                                            var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                                            return !~text.indexOf(val);
                                        }).hide();
                                    });

                                    $(document).ready(function () {
                                        $searchrows.click(function () {
                                            var select = $(this).val();
                                            $.ajax({
                                                type: "GET",
                                                url: "{% url 'getdata' %}",
                                                data: {
                                                    id: select
                                                }
                                            }).done(function (response) {
                                                var json_data = JSON.parse(response);
                                                for (key in json_data) {
                                                    document.getElementById('email').value = json_data[key]['email'];

                                                    var selectElement = document.getElementById("plosu");
                                                    place = json_data[key]['placeofsupply'];
                                                    // Loop through the options to find the one you want to select
                                                    for (var i = 0; i < selectElement.options.length; i++) {
                                                        if (selectElement.options[i].value === place) {

                                                            // Set the selected attribute of the desired option to true
                                                            selectElement.selectedIndex = i;
                                                            break; // Exit the loop once the option is selected
                                                        }
                                                    }

                                                    $('#gst_trt_inp1').val(" " + json_data[key]['gsttype']);

                                                    if (json_data[key]['gsttype'] === "unregistered Business" || json_data[key]['gsttype'] === "Consumer" || json_data[key]['gsttype'] === "Overseas") {
                                                        $("#gstin_row1").addClass('d-none');
                                                        $("#gstin_row1").removeClass('d-flex');
                                                    } else {
                                                        $("#gstin_row1").removeClass('d-none');
                                                        $("#gstin_row1").addClass('d-flex');
                                                        $('#gstin_inp1').val(" " + json_data[key]['gstin']);
                                                    }


                                                    document.getElementById('bname').value = json_data[key]['company'] + ',\n' + json_data[key]['street'] + ',\n' + json_data[key]['city'] + ',\n' + json_data[key]['state'] + ',\n' + json_data[key]['pincode'];
                                                    document.getElementById('searchInput').value = json_data[key]['firstname'] + ' ' + json_data[key]['lastname'];
                                                    document.getElementById('customerid').value = json_data[key]['customerid'];

                                                    $(document).ready(function () {
                                                        var RowCount = table.rows.length;
                                                        for (var i = 1; i <= RowCount; i++) {
                                                            // Generate table row
                                                            // ...

                                                            // Call toggleDateInput function for each row
                                                            toggleDateInput(i);
                                                        }
                                                    });
                                                }
                                            })
                                        });
                                    });


                                </script>
                            </div>

                            <label class="col-form-label mt-4 mb-2">Email </label>
                            <input class="custom-select" name="email" placeholder="Email" value="{{ch.customer.email}}"
                                required style="background-color: #2f516f; color: white;" onclick="calc()" id="email"
                                readonly>

                            <label for="gst_trt_inp" class="mt-4">GST Treatment</label>
                            <input type="text" class="form-control" id="gst_trt_inp1" value="{{ch.customer.gsttype}}"
                                name="gst_trt_inp" readonly>

                            <div class="d-none" id="gstin_row1" style="flex-direction: column;">
                                <label for="gstin_inp" class="mt-4">GST Number</label>
                                <input type="text" class="form-control" id="gstin_inp1" name="gstin_inp" readonly>
                            </div>
                        </div>


                        <div class="col-md-5 ml-4 mt-3">
                            <label class="text-gray-light">Bill To:</label>
                            <textarea class="form-control" name="bname" id="bname" onclick="calc()" rows="7" type="text"
                                value="{{ch.billto}}" style="background-color: #2f516f; color: white;"
                                readonly>{{ch.billto}}</textarea>

                            <label class="col-form-label mt-4">Place of supply</label>
                            <select type="text" class="form-control " id="plosu" name="placosupply"
                                style="background-color: #2f516f; color: white;" onclick="calc()" onclick="state">
                                <option value="{{ch.pl}}" hidden selected>{{ch.pl}}</option>
                                <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                                <option value="[AD]-Andhra Pradhesh">[AD] Andhra Pradhesh</option>
                                <option value="[AR]-Arunachal Pradesh">[AR] Arunachal Pradesh</option>
                                <option value="[AS]-Assam">[AS] Assam</option>
                                <option value="[BR]-Bihar">[BR] Bihar</option>
                                <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                                <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                                <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                                <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                                <option value="[DL]-Delhi">[DL] Delhi</option>
                                <option value="[GA]-Goa">[GA] Goa</option>
                                <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                                <option value="[HR]-Haryana">[HR] Haryana</option>
                                <option value="[HP]-Himachal Pradesh">[HP] Himachal Pradesh</option>
                                <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                                <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                                <option value="[KA]-Karnataka">[KA] Karnataka</option>
                                <option value="[KL]-Kerala">[KL] Kerala</option>
                                <option value="[LA]-Ladakh">[LA] Ladakh</option>
                                <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                                <option value="[MP]-Madhya Pradesh">[MP] Madhya Pradesh</option>
                                <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                                <option value="[MN]-Manipur">[MN] Manipur</option>
                                <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                                <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                                <option value="[NL]-Nagaland">[NL] Nagaland</option>
                                <option value="[OD]-Odisha">[OD] Odisha</option>
                                <option value="[PY]-Puducherry">[PY] Puducherry</option>
                                <option value="[PB]-Punjab">[PB] Punjab</option>
                                <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                                <option value="[SK]-Sikkim">[SK] Sikkim</option>
                                <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                                <option value="[TS]-Telangana">[TS] Telangana</option>
                                <option value="[TR]-Tripura">[TR] Tripura</option>
                                <option value="[UP]-Uttar Pradesh">[UP] Uttar Pradesh</option>
                                <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                                <option value="[WB]-West Bengal">[WB] West Bengal</option>
                                <option value="[OT]-Other Territory">[OT] Other Territory</option>
                            </select>
                        </div>
                        <div class="col-md-3 mt-3">
                            <input type="number" class="form-control mt-4" id="newtrm" placeholder="0"
                                onchange="addtemopt(this)" style="display: none;">
                        </div>
                        <div class="col-md-3 mt-3"></div>

                    </div>

                    <hr>
                    <div class="row">
                        <div class="col-md-5 ml-4 mt-2 mr-4">
                            <label class="col-form-label">Challan number</label>
                            <input type="text" id="challan_num" class="form-control" name="chal_no"
                                value="{{ch.chal_no}}" style="background-color: #2f516f; color: white;"
                                onselect="calc()">
                            <span id="challan_warning" class="text-danger"></span>
                        </div>

                        <div class="col-md-5 ml-4 mt-2">
                            <label class="col-form-label">Challan Date:</label>
                            <div>
                                <input type="date" value="{{ ch.challan_date |date:'Y-m-d'}}" class="form-control"
                                    name="challandate" style="background-color: #2f516f; color: white;">
                            </div>
                        </div>
                    </div>


                    <div class="row">

                        <div class="col-md-5 ml-4 mt-3 mr-4">
                            <label class="col-form-label">Challan Type </label>
                            <div>
                                <select class="custom-select" onclick="calc()" name="terms" required
                                    style="background-color: #2f516f; color: white;" id="termadd"
                                    onclick="showinp('newtrm', this)">
                                    <option selected value="{{ch.challan_type}}">{{ch.challan_type}}</option>
                                    <option value="Supply of Liquid Gas">Supply of Liquid Gas</option>
                                    <option value="Job Work">Job Work</option>
                                    <option value="Supply on Approval">Supply on Approval</option>
                                    <option value="Others">Others</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-5 ml-4 mt-3">
                            <label class="col-form-label">Refrence number</label>
                            <input type="text" id="ref" readonly value="{{ch.ref}}" class="form-control" name="ref"
                                style="background-color: #2f516f; color: white;" onselect="calc()">
                        </div>
                        <div class="col-md-3 mt-3"></div>
                        <div class="col-md-3 mt-3"></div>
                    </div>




                    <!-- <div class="row">
            <div class="col-md-5 ml-4 mt-3 mr-4">
              <label class="col-form-label">Place of supply</label>
              <select type="text" class="form-control " id="plosu" name="placosupply" style="background-color: #2f516f; color: white;" onclick="calc()" onclick="state">
                <option value="{{ch.pl}}">{{ch.pl}}</option>
                <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads</option>
                <option value="Andhra Predhesh">Andhra Predhesh</option>
                <option value="Arunachal Predesh">Arunachal Predesh</option>
                <option value="Assam">Assam</option>
                <option value="Bihar">Bihar</option>
                <option value="Chandigarh">Chandigarh</option>
                <option value="Chhattisgarh">Chhattisgarh</option>
                <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                <option value="Damn anad Diu">Damn anad Diu</option>
                <option value="Delhi">Delhi</option>
                <option value="Goa">Goa</option>
                <option value="Gujarat">Gujarat</option>
                <option value="Haryana">Haryana</option>
                <option value="Himachal Predesh">Himachal Predesh</option>
                <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                <option value="Jharkhand">Jharkhand</option>
                <option value="Karnataka">Karnataka</option>
                <option value="Kerala">Kerala</option>
                <option value="Ladakh">Ladakh</option>
                <option value="Lakshadweep">Lakshadweep</option>
                <option value="Madhya Predesh">Madhya Predesh</option>
                <option value="Maharashtra">Maharashtra</option>
                <option value="Manipur">Manipur</option>
                <option value="Meghalaya">Meghalaya</option>
                <option value="Mizoram">Mizoram</option>
                <option value="Nagaland">Nagaland</option>
                <option value="Odisha">Odisha</option>
                <option value="Puducherry">Puducherry</option>
                <option value="Punjab">Punjab</option>
                <option value="Rajasthan">Rajasthan</option>
                <option value="Sikkim">Sikkim</option>
                <option value="Tamil Nadu">Tamil Nadu</option>
                <option value="Telangana">Telangana</option>
                <option value="Tripura">Tripura</option>
                <option value="Uttar Predesh">Uttar Predesh</option>
                <option value="Uttarakhand">Uttarakhand</option>
                <option value="West Bengal">West Bengal</option>
                <option value="Other Territory">Other Territory</option>
              </select>
            </div>
            <div class="col-md-3 mt-3"></div>
            <div class="col-md-3 mt-3"></div>
            <div class="col-md-3 mt-3"></div>
          </div> -->
                    <div class="row clearfix">
                        <div class="col-md-12 table-responsive-md mt-3">
                            <table class="table table-bordered table-hover mt-3 text-white" id="item_table"
                                onchange="calc()">
                                <thead>
                                    <tr>
                                        <th>no</th>
                                        <th>Product
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a
                                                href="#" class=" btn-outline-secondary" data-bs-target="#newitem"
                                                data-bs-toggle="modal"><span class="fa fa-plus large"></span>Add
                                                Item</a></th>
                                        <th class="text-right">Hsn</th>
                                        <th class="text-right">Quantity</th>
                                        <th class="text-right">Rate</th>
                                        <th class="text-right">Discount</th>
                                        <th class="text-right">Tax %</th>
                                        <th class="text-right">Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for k in chitem %}
                                    {% with counter=forloop.counter %}

                                    <tr>
                                        <td>{{ counter }}</td>

                                        <td style="width: 18%;" class="text-right">
                                            <div class='form-group mt-3 d-flex align-items-center'>
                                                <input type="text" id="itemsearchInput{{ counter }}"
                                                    placeholder="Search..." class="dropdown-toggle form-control "
                                                    autocomplete="off" data-toggle="dropdown"
                                                    onclick="itemfunction(this.id)" value="{{k.product}}">
                                                <input type="text" name="item[]" id="item{{counter }}"
                                                    style="display: none;" value="{{k.item.id}}">
                                                <div class="dropdown-menu itm{{counter}}"
                                                    style="background-color: #000; width: 17%;border-radius: 4px;">
                                                    {% for i in item %}
                                                    <option class="dropdown-item" id="dd-item{{ counter }}"
                                                        value="{{ i.id }}">
                                                        {{i.name }}
                                                    </option>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </td>

                                        <td class='text-right '>
                                            <div>
                                                <input type='text' id='hsn{{ counter }}'
                                                    class='form-control  border-0 text-black text-right hsn'
                                                    name='hsn[]' value={{k.hsn}} onchange="validateHSN(this)">
                                            </div>
                                        </td>
                                        <script>
                                            $(document).on("input", ".hsn", function () {
                                                var hsn_value = $(this).val();
                                                var hsn_length = hsn_value.length;
                                                if (hsn_length > 6) {
                                                    $(this).val(hsn_value.substring(0, 6));
                                                    alert("HSN should not be more than 6 digits!");
                                                }
                                            });


                                        </script>


                                        <td class='text-right' style="position: relative;"><input type='number'
                                                id='qty{{ counter }}'
                                                class='form-control border-0 text-black text-right qty'
                                                name='quantity[]' value='{{k.quantity}}' onclick="calc()">
                                        </td>

                                        <td class='text-right'><input type='number' id='rate{{ counter }}'
                                                class='form-control border-0 text-black text-right rate' name='rate[]'
                                                value='{{k.rate}}' onclick="calc()">
                                        </td>
                                        <input type='hidden' id='desc{{ counter }}'
                                            class='form-control border-0 text-black text-right desc' name='desc[]'
                                            onclick="calc()">
                                        <td style='width:10%'>
                                            <input type="number" value='{{k.discount}}' name='discount[]'
                                                id="discount{{counter}}" class="form-control discount"
                                                onclick="calc()" />
                                        </td>
                                        <td style="width: 13%;" class='text-right'> <select name="tax[]"
                                                id="tax{{ counter }}"
                                                class='form-control border-0 text-black text-right tax'
                                                onclick="state(this)" onselect="calc()">
                                                <optgroup label="GST" style="background-color: black;"
                                                    class="text-center">
                                                    <option value="{{k.tax}}" selected hidden>GST {{k.tax}}%</option>
                                                    <option value="0">GST 0%</option>
                                                    <option value="3">GST 3%</option>
                                                    <option value="5">GST 5%</option>
                                                    <option value="12">GST 12%</option>
                                                    <option value="18">GST 18%</option>
                                                    <option value="28">GST 28%</option>
                                                </optgroup>
                                                <optgroup label="IGST" style="background-color: black;"
                                                    class="text-center">
                                                    <option value="{{k.tax}}" selected hidden>IGST {{k.tax}}%</option>
                                                    <option value="0">IGST 0%</option>
                                                    <option value="3">IGST 3%</option>
                                                    <option value="5">IGST 5%</option>
                                                    <option value="12">IGST 12%</option>
                                                    <option value="18">IGST 18%</option>
                                                    <option value="28">IGST 28%</option>
                                                </optgroup>
                                            </select>

                                            <script>
                                                function validateHSN(hsnInput) {
                                                    var hsn = hsnInput.value;
                                                    var errorSpan = hsnInput.nextElementSibling;
                                                    var valid = true;

                                                    if (hsn.length != 6) {
                                                        errorSpan.innerHTML = "HSN must be 6 digits long";
                                                        valid = false;
                                                    } else {
                                                        errorSpan.innerHTML = "&#x2713;"; // Check mark
                                                    }

                                                    return valid;
                                                }

                                            </script>


                                            <script>

                                                $(document).ready(function () {
                                                    // add event listener to trigger calc() function whenever a change is made to input fields
                                                    $('#item_table').on('input', 'input', calc);
                                                });

                                                $(document).ready(function () {
                                                    // window.onload(function(){
                                                    // alert(`{{ch.customer.gsttype}}`)
                                                    if (`{{ch.customer.gsttype}}` === "unregistered Business" || `{{ch.customer.gsttype}}` === "Consumer" || `{{ch.customer.gsttype}}` === "Overseas") {
                                                        $("#gstin_row1").addClass('d-none');
                                                        $("#gstin_row1").removeClass('d-flex');
                                                    } else {
                                                        $("#gstin_row1").removeClass('d-none');
                                                        $("#gstin_row1").addClass('d-flex');
                                                        $('#gstin_inp1').val("" + `{{ch.customer.gstin}}`);
                                                    }
                                                    // })
                                                })

                                                $(document).ready(function () {
                                                    $('#challan_num').on('blur', function () {
                                                        var num = $('#challan_num').val();
                                                        //   alert(num)
                                                        $.ajax({
                                                            type: "GET",
                                                            url: "{% url 'checkDCNumberConti' %}",
                                                            data: {
                                                                challan_number: num
                                                            }
                                                        }).done(function (response) {
                                                            console.log(response.status);
                                                            console.log(response.message);
                                                            if (!response.status) {
                                                                $('#challan_warning').text(response.message);
                                                            }
                                                            else {
                                                                $('#challan_warning').text("");
                                                            }
                                                        })
                                                    });
                                                })

                                                function calc() {
                                                    // loop through each row in the table
                                                    $('#item_table tbody tr').each(function () {
                                                        // get the values of the input fields for this row
                                                        var qty = $(this).find('.qty').val();
                                                        var rate = $(this).find('.rate').val();
                                                        var desc = $(this).find('.desc').val();
                                                        var tax = $(this).find('.tax').val();
                                                        var discount = $(this).find('.discount').val();


                                                        // calculate the tax amount and total amount for this row
                                                        var dis = qty * rate;
                                                        var amount = dis - discount;
                                                        var taxamount = (amount) * (tax / 100);

                                                        // update the tax amount and total amount input fields for this row
                                                        $(this).find('.taxamount').val(taxamount.toFixed(2));
                                                        $(this).find('.amount').val(amount.toFixed(2));
                                                    });

                                                    // calculate the total amount and total tax amount for all rows
                                                    var total = 0;
                                                    var taxamount = 0;
                                                    $('.amount').each(function () {
                                                        total += parseFloat($(this).val());
                                                    });
                                                    $('.taxamount').each(function () {
                                                        taxamount += parseFloat($(this).val());
                                                    });

                                                    // get the shipping charge value
                                                    var shippingCharge = parseFloat($('#ship').val());

                                                    var Adjustment = parseFloat($('#Adjustment').val());



                                                    // update the subtotal and total tax amount input fields
                                                    $('#subtotal').val(total.toFixed(2));
                                                    $('#total_taxamount').val(taxamount.toFixed(2));

                                                    // calculate the total amount including tax and shipping charge
                                                    var total_with_tax = total + taxamount;

                                                    // check if shipping charge exists
                                                    if (!isNaN(shippingCharge) && shippingCharge !== 0) {
                                                        total_with_tax += shippingCharge;
                                                        $('#total_with_tax').val(total_with_tax.toFixed(2));
                                                    } else {
                                                        $('#total_with_tax').val(total_with_tax.toFixed(2));
                                                    }

                                                    // Event listener for the shipping input field
                                                    $('#ship').on('input', function () {
                                                        calc(); // Call the calc() function whenever the shipping value changes
                                                    });


                                                    // check if adjustment charge exists
                                                    if (!isNaN(Adjustment) && Adjustment !== 0) {
                                                        total_with_tax += Adjustment;
                                                        $('#total_with_tax').val(total_with_tax.toFixed(2));
                                                    } else {
                                                        $('#total_with_tax').val(total_with_tax.toFixed(2));
                                                    }

                                                    // Event listener for the adjustment input field    
                                                    $('#Adjustment').on('input', function () {
                                                        calc(); // Call the calc() function whenever the adjustment value changes
                                                    });

                                                    // calculate the total amount including tax and shipping charge
                                                    var total_with_tax = total + taxamount;

                                                    test(taxamount);


                                                }


                                                // Update subtotal when a row is deleted
                                                $(document).ready(function dlt() {
                                                    $('#item_table').on('click', '.delete-row', function () {
                                                        var tr = $(this).closest('tr');
                                                        var taxamount = parseFloat(tr.find('input[name^="taxamount"]').val());
                                                        var amount = parseFloat(tr.find('input[name^="amount"]').val());
                                                        var subtotal = parseFloat($('#subtotal').val());

                                                        var total_taxamount = parseFloat($('#total_taxamount').val());
                                                        $('#total_taxamount').val((total_taxamount - taxamount).toFixed(2));

                                                        $('#subtotal').val((subtotal - amount).toFixed(2));

                                                        var total_with_tax = parseFloat($('#total_with_tax').val());
                                                        $('#total_with_tax').val((total_with_tax - amount - taxamount).toFixed(2));




                                                        tr.remove();


                                                    });
                                                });


                                                function test(taxamount) {
                                                    var d = 0;
                                                    var pos = document.getElementById('plosu');
                                                    var vale = checkbox.value;
                                                    // Find the index of the hyphen
                                                    var index = vale.indexOf("-");
                                                    // Remove the first letters before the hyphen
                                                    var pos = vale.substring(index + 1);
                                                    var state = "{{cmp1.state}}";
                                                    if (pos == state) {
                                                        gst = taxamount / 2;
                                                        $('#cgst').val(parseFloat(gst.toFixed(2)));
                                                        $('#sgst').val(parseFloat(gst.toFixed(2)));
                                                        $('#igst').val(parseFloat(d.toFixed(2)));

                                                    }
                                                    else {
                                                        gst = taxamount;
                                                        $('#cgst').val(parseFloat(d.toFixed(2)));
                                                        $('#sgst').val(parseFloat(d.toFixed(2)));
                                                        $('#igst').val(parseFloat(gst.toFixed(2)));
                                                    }

                                                }
                                            </script>
                                            </script>
                                            <style>
                                                .hsn-validation {
                                                    font-size: 1.2em;
                                                    color: red;
                                                }

                                                .hsn-validation::before {
                                                    display: inline-block;
                                                    content: attr(data-content);
                                                    width: 1em;
                                                    height: 1em;
                                                    margin-right: 0.2em;
                                                    text-align: center;
                                                    vertical-align: middle;
                                                    color: green;
                                                }
                                            </style>

                                        </td>
                                        <td style="display: none;">
                                            <input type="text" name='taxamount[]' id="taxamount{{ counter }}"
                                                class="form-control taxamount" />
                                        </td>
                                        <td class='text-right'><input type='number' id='amount{{ counter }}'
                                                class='form-control border-0 text-black text-right amount'
                                                name='amount[]' value='{{k.total}}'></td>
                                        <td class='text-center'><button type='button' id='del_btn{{ counter }}'
                                                class='btn btn-transparent mb-1 text-danger btn-sm btn-outline-danger remove_row rounded-circle delete-row'
                                                style='width:30px'>--</button>

                                        </td>


                                    </tr>
                                    {% endwith %}

                                    {% endfor %}
                                </tbody>

                            </table>
                            <button type="button" class="btn btn-outline-secondary ml-1" onclick="calc()"
                                id="add-row">+</button>



                        </div>
                    </div>


                    <div class="row clearfix " style="margin-top:20px">
                        <div class="col-md-6">

                            <textarea class="form-control mt-5" id="" name="Note" value="{{ch.note}}" placeholder="Note"
                                style="height: 190px;">{{ch.note}}</textarea>

                            <input type="file" name="file" style="margin-top: 10px; width: 70%;">
                        </div>

                        <div class="col-md-1"></div>

                        <div class="col-md-5 table-responsive-md mt-3 " id="tab_logic_total"
                            style="background-color:rgba(0,0,0,.4); border: 1px solid rgba(128, 128, 128, 0.6);">

                            <div class="p-3">
                                <div class="row container-fluid p-2 m-0">

                                    <div class="col-sm-4 mt-2"> <label class="text-center ">Sub Total</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"> <input type="number" value="{{ch.subtotal}}" step="any"
                                            placeholder=0 class="form-control" id="subtotal" name="subtotal" readonly />
                                    </div>
                                </div>


                                <div class="row container-fluid p-2 m-0" id="tr_igst">
                                    <div class="col-sm-4 mt-2"><label class="text-center ">IGST</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id='igst' name="igst"
                                            value="{{ch.igst}}" placeholder='0.00' class="form-control" readonly />
                                    </div>

                                </div>

                                <div class="row container-fluid p-2 m-0" id="tr_cgst">
                                    <div class="col-sm-4 mt-2"><label class="text-center">CGST</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id='cgst' name="cgst" step="any"
                                            placeholder=0 class="form-control" value="{{ch.cgst}}" readonly /></div>

                                </div>

                                <div class="row container-fluid p-2 m-0" id="tr_sgst">
                                    <div class="col-sm-4 mt-2"><label class="text-center">SGST</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id='sgst' name="sgst" step="any"
                                            placeholder=0 class="form-control" value="{{ch.sgst}}" readonly /></div>

                                </div>


                                <div class="row container-fluid p-2 m-0">
                                    <div class="col-sm-4 mt-2"><label class="text-center">Total Tax</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id="total_taxamount"
                                            value="{{ch.taxamount}}" name="totaltax" placeholder=0 step="any"
                                            class="form-control" readonly /></div>

                                </div>


                                <div class="row container-fluid p-2 m-0">
                                    <div class="col-sm-4 mt-2"><label class="text-center" onclick="calc()">Shipping
                                            Charge</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id="ship" name="ship"
                                            value="{{ch.shipping}}" placeholder=0 step="any" value="0" required
                                            class="form-control ship" /></div>

                                </div>
                                <div class="row container-fluid p-2 m-0">
                                    <div class="col-sm-4 mt-2"><label class="text-center"
                                            oninput="calc()">Adjustment</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" id="Adjustment" name="Adjustment"
                                            value="{{ch.adjustment}}" placeholder=0 step="any" value="0" required
                                            class="form-control" /></div>


                                </div>

                                <div class="row container-fluid p-2 m-0">
                                    <div class="col-sm-4 mt-2"><label class="text-center">Grand Total</label></div>
                                    <div class="col-sm-1 mt-2">:</div>
                                    <div class="col-sm-7 mt-2"><input type="number" value={{ch.grand}}
                                            id="total_with_tax" name="t_total" value=0 step="any" class="form-control"
                                            readonly /></div>

                                </div>








                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-10 mt-3"></div>
                        <!-- <div class="col-md-2 mt-3">
              <button type="submit"  class="btn btn-outline-info rounded-pill w-100 text-grey pull-left">
                Save To Draft
              </button>
            </div> -->
                        <div class="col-md-2 mt-3">
                            <button type="submit" class="btn btn-outline-info rounded-pill w-100 text-grey pull-left">
                                Save
                            </button>
                        </div>
                    </div>
                    <div class="notices mt-3">
                        <div class="text-muted">NOTICE:</div>
                        <div class="text-muted">
                            Fin sYs Terms and Conditions Apply
                        </div>
                    </div>
                    <footer class="text-muted">Delivery Challan was created on a computer and is valid without the
                        signature and seal.
                    </footer>
                </div>
            </div>
        </div>
    </div>
</form>
<script>
    $(document).on('click', '.remove_row', function () {

        const response = confirm("Are you sure you want to do that?");

        if (response) {
            var row_id = $(this).closest('tr');
            var rowprd = document.getElementById('item' + row_id).value
            var crdid = '{{ch.id}}'
            console.log('remove')
            console.log(crdid)
            $.ajax({
                type: "GET",
                url: "{% url 'removecl' %}",
                data: {
                    id: rowprd,
                    cr: crdid

                }
            });
            $('#addr0' + row_id + '').remove();
            calc()
        } else {
            pass;
        }

        // var row_id = $(this).attr("id");

        // $('#'+row_id).remove();
        // $('#addr0'+row_id).remove();
        // calc()


    });
</script>



<!-- modal hsncode edit -->


<div class="modal fade" id="edithsn" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit HSN Code</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <input type="text" id="edithsn1" class="form-control">

                    <button class="btn btn-outline-info rounded-pill text-grey  mt-3 mb-3 " type="submit">
                        Save
                    </button>
                </form>
            </div>

        </div>
    </div>
</div>


<!-- modal hsncode edit -->




<!-- 
    modal -->

<div class="modal fade" id="newcust">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: #213b52;">
            <div class="modal-header">
                <h3 class="m-3">ADD CUSTOMER</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <form method="POST" autocomplete="off">{% csrf_token %}

                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom01">Title</label>
                            <select name="title" id="title" class="form-control" id="validationCustom01">
                                <option value="Mr">Mr</option>
                                <option value="Mrs">Mrs</option>
                                <option value="Miss">Miss</option>
                                <option value="Ms">Ms</option>
                            </select>
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom02">First name</label>
                            <input type="text" class="form-control" id="firstname" name="firstname" required
                                style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom02">Last name</label>
                            <input type="text" class="form-control" id="lastname" name="lastname" required
                                style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom03">Company</label>
                            <input type="text" class="form-control" id="company" name="company"
                                style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom03">Location</label>
                            <input type="text" class="form-control" id="location" name="location"
                                style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label>Place of Supply *</label>
                            <select class="custom-select form-control" id="placeof_supply" name="placeof_supply"
                                style="background-color: #2f516f; color: white;" required>
                                <option selected value="" hidden>Select Place of Supply</option>
                                <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                                <option value="[AD]-Andhra Pradhesh">[AD] Andhra Pradhesh</option>
                                <option value="[AR]-Arunachal Pradesh">[AR] Arunachal Pradesh</option>
                                <option value="[AS]-Assam">[AS] Assam</option>
                                <option value="[BR]-Bihar">[BR] Bihar</option>
                                <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                                <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                                <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                                <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                                <option value="[DL]-Delhi">[DL] Delhi</option>
                                <option value="[GA]-Goa">[GA] Goa</option>
                                <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                                <option value="[HR]-Haryana">[HR] Haryana</option>
                                <option value="[HP]-Himachal Pradesh">[HP] Himachal Pradesh</option>
                                <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                                <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                                <option value="[KA]-Karnataka">[KA] Karnataka</option>
                                <option value="[KL]-Kerala">[KL] Kerala</option>
                                <option value="[LA]-Ladakh">[LA] Ladakh</option>
                                <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                                <option value="[MP]-Madhya Pradesh">[MP] Madhya Pradesh</option>
                                <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                                <option value="[MN]-Manipur">[MN] Manipur</option>
                                <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                                <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                                <option value="[NL]-Nagaland">[NL] Nagaland</option>
                                <option value="[OD]-Odisha">[OD] Odisha</option>
                                <option value="[PY]-Puducherry">[PY] Puducherry</option>
                                <option value="[PB]-Punjab">[PB] Punjab</option>
                                <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                                <option value="[SK]-Sikkim">[SK] Sikkim</option>
                                <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                                <option value="[TS]-Telangana">[TS] Telangana</option>
                                <option value="[TR]-Tripura">[TR] Tripura</option>
                                <option value="[UP]-Uttar Pradesh">[UP] Uttar Pradesh</option>
                                <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                                <option value="[WB]-West Bengal">[WB] West Bengal</option>
                                <option value="[OT]-Other Territory">[OT] Other Territory</option>
                            </select>
                            <div class="invalid-feedback">Please select a valid registration type.</div>
                        </div>
                        <div class="col-md-4 mt-3"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom04">GST type</label>
                            <select class="custom-select" id="gsttype" name="gsttype"
                                onclick="hidinput('hello1',this)   " required
                                style="background-color: #2f516f; color: white;">
                                <option selected disabled value="">Select GST Type</option>
                                <option value="Registered Business - Regular">Registered Business - Regular
                                    <span><i>(Business that is registered under gst)</i></span>
                                </option>
                                <option value="Registered Business - Composition">Registered Business - Composition
                                    (Business that is registered under composition scheme in gst)</option>
                                <option value="unregistered Business">Unregistered Business (Business that has not been
                                    registered under gst)</option>
                                <option value="Overseas">Overseas (Import/Export of supply outside india)</option>
                                <option value="Consumer">Consumer</option>
                                <option value="Special Economic Zone (SEZ)">Special Economic Zone (SEZ) (Business that
                                    is located in a special economic zone of india or a SEZ developer)</option>
                                <option value="Demed Exports">Demed Exports (Supply of woods to an exports oriented unit
                                    or againsed advanced authorization or export promotion capital woods)</option>
                                <option value="Tax Deductor">Tax Deductor (State of central gov,government agencies or
                                    local authority)</option>
                                <option value="SEZ Developer">SEZ Developer (A person or organization who owns atleast
                                    26% eqaulity in creating business units in special economic zone)</option>
                            </select>
                            <div class="invalid-feedback">Please select a valid registration type.</div>
                        </div>

                        <div class="col-md-4 mt-3" id="hello1" style="display: none;">
                            <div>
                                <label for="validationCustom05">GSTIN</label>
                                <input type="text" class="form-control" onchange="checkgst(this)" id="gstin"
                                    name="gstin" style="background-color: #2f516f;color: white;" value=""
                                    placeholder="29APPCK7465F1Z1">
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div>


                        <!-- <div class="col-md-4 mt-3" id="hai">
                            <div >
                                <label for="validationCustom05">BUSINESS LEGAL NAME</label>
                                <input type="text" class="form-control" 
                                       
                                       style="background-color: #2f516f;color: white;"
                                       >
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div>

                        <div class="col-md-4 mt-3" id="hai1">
                            <div >
                                <label for="validationCustom05">BUSINESS TRADE NAME</label>
                                <input type="text" class="form-control" 
                                       
                                       style="background-color: #2f516f;color: white;"
                                       >
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div> -->



                        <div class="col-md-4 mt-3">
                            <label for="validationCustom03">PAN NO</label>
                            <input type="text" class="form-control" id="panno" name="panno"
                                style="background-color: #2f516f;color: white;" onchange="checkpan(this)"
                                placeholder="APPCK7465F">
                            <div class="text-danger m-2" id="warnpan"></div>
                        </div>

                        <div class="col-md-4 mt-3">
                            <div>
                                <label for="validationCustom05">OPENING BALANCE</label>
                                <div class="d-flex">
                                    <select name="bal" id="bal" class="form-select text-white pl-1"
                                        style="background-color: #243e54; width: 25%; border-radius: 5px;">
                                        <option value="credit">Credit</option>
                                        <option value="debit">Debit</option>
                                    </select>
                                    <input type="text" class="form-control" value="" name="openbalance" id="openbalance"
                                        style="background-color: #2f516f;color: white;">
                                    <div class="text-danger m-2"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom05">Credit Limit</label>
                            <input type="text" class="form-control" name="crd_lmt"
                                style="background-color: #2f516f;color: white;" id="crd_lmt">
                            <div class="text-danger m-2"></div>
                        </div>


                        <!-- <div class="col-md-4 mt-3" id="hai1">
                            <div >
                                <label for="validationCustom05">PLACE OF SUPPLY</label>
                                <input type="text" class="form-control" 
                                       
                                       style="background-color: #2f516f;color: white;"
                                       >
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div>

                        <div class="col-md-4 mt-3" id="hai1">
                            <div >
                                <label for="validationCustom05">TAX PERFERENCE</label>
                                <input type="text" class="form-control" 
                                       
                                       style="background-color: #2f516f;color: white;">
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div>
                        <div class="col-md-4 mt-3" >
                            <div>
                                <label for="validationCustom05">TAX RETURNS</label><br>
                                <input type="radio" name="Returns" 
                                       
                                       style="background-color: #2f516f;color: white;"> Taxable
                                       <input type="radio" name="Returns"  
                                       style="background-color: #2f516f;color: white;"> Non Taxable
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div> -->
                    </div>





                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom03">Email</label>
                            <input type="email" class="form-control" id="email1" name="email"
                                style="background-color: #2f516f;color: white;" placeholder="finsys@mail.com"
                                onchange="validateEmail(this)">
                            <div id="warneamil" class="text-danger"></div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom03">Website</label>
                            <input type="text" class="form-control" id="website" placeholder="www.finsys.com"
                                onchange="checkweb(this)" name="website"
                                style="background-color: #2f516f;color: white;">
                            <div id="warnweb" class="text-danger"></div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom01">Mobile</label>
                            <input type="text" class="form-control" id="mobile" onchange="checkphone(this)"
                                name="mobile" style="background-color: #2f516f;color: white;">
                            <div class="text-danger m-2" id="warnphone"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label>Price List</label>
                            <select class="custom-select" id="p_list" name="p_list"
                                style="background-color: #2f516f; color: white;">
                                <option selected value="" hidden>Select Price List</option>
                                {% for i in price_list %}
                                <option value="{{i.id}}">{{i.percentage}}%</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label>Payment Terms</label>
                            <select class="custom-select" id="pay_term" name="pay_term"
                                style="background-color: #2f516f; color: white;" required>
                                <option selected value="" hidden>Select Payment Term</option>
                                {% for i in pay_terms %}
                                <option value="{{i.term}}">{{i.term}}</option>
                                {% endfor %}
                            </select>

                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-6 mt-5">
                            <div class="row">
                                <div class="col-md-12 card-title">
                                    <h5 class="mb-0">Billing Address</h5>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mt-3">
                                    <div class="form-row">
                                        <label for="street">Street</label>
                                        <textarea class="form-control street" id="street" name="street"
                                            style="background-color: #2f516f;color: white;"></textarea>
                                        <div class="invalid-feedback">Please provide a valid Street</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="city">City</label>
                                        <input type="text" class="form-control" id="city" name="city"
                                            style="background-color: #2f516f;color: white;" placeholder="City">
                                        <div class="invalid-feedback">Please provide a valid City</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="state">State</label>
                                        <select type="text" class="form-control" id="state" name="state" required
                                            style="background-color: #2f516f; color: white;">
                                            <option value="" disabled selected>Choose</option>
                                            <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                                            </option>
                                            <option value="Andhra Predhesh">Andhra Predhesh</option>
                                            <option value="Arunachal Predesh">Arunachal Predesh</option>
                                            <option value="Assam">Assam</option>
                                            <option value="Bihar">Bihar</option>
                                            <option value="Chandigarh">Chandigarh</option>
                                            <option value="Chhattisgarh">Chhattisgarh</option>
                                            <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                                            <option value="Damn anad Diu">Damn anad Diu</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Goa">Goa</option>
                                            <option value="Gujarat">Gujarat</option>
                                            <option value="Haryana">Haryana</option>
                                            <option value="Himachal Predesh">Himachal Predesh</option>
                                            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                            <option value="Jharkhand">Jharkhand</option>
                                            <option value="Karnataka">Karnataka</option>
                                            <option value="Kerala">Kerala</option>
                                            <option value="Ladakh">Ladakh</option>
                                            <option value="Lakshadweep">Lakshadweep</option>
                                            <option value="Madhya Predesh">Madhya Predesh</option>
                                            <option value="Maharashtra">Maharashtra</option>
                                            <option value="Manipur">Manipur</option>
                                            <option value="Meghalaya">Meghalaya</option>
                                            <option value="Mizoram">Mizoram</option>
                                            <option value="Nagaland">Nagaland</option>
                                            <option value="Odisha">Odisha</option>
                                            <option value="Puducherry">Puducherry</option>
                                            <option value="Punjab">Punjab</option>
                                            <option value="Rajasthan">Rajasthan</option>
                                            <option value="Sikkim">Sikkim</option>
                                            <option value="Tamil Nadu">Tamil Nadu</option>
                                            <option value="Telangana">Telangana</option>
                                            <option value="Tripura">Tripura</option>
                                            <option value="Uttar Predesh">Uttar Predesh</option>
                                            <option value="Uttarakhand">Uttarakhand</option>
                                            <option value="West Bengal">West Bengal</option>
                                            <option value="Other Territory">Other Territory</option>
                                        </select>
                                        <div class="invalid-feedback">Please provide a valid State</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="pinco">Pin Code</label>
                                        <input type="text" class="form-control" id="pinco" name="pincode"
                                            style="background-color: #2f516f;color: white;" placeholder="PIN code">
                                        <div class="invalid-feedback">Please provide a valid Pin Code</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="country">Country</label>
                                        <input type="text" class="form-control" id="country" name="country"
                                            style="background-color: #2f516f;color: white;" placeholder="Country">
                                        <div class="invalid-feedback">Please provide a valid Country</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mt-5">
                            <div class="row">
                                <div class="col-md-12 d-flex">
                                    <h5>Shipping Address</h5>
                                    <input class="ml-4 mt-2 ml-2" type="checkbox" onclick="poppins()" id="okay"
                                        name="okay">
                                    <label class="ml-2 mt-1 ml-2" for="okay">Same As Billing Address</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mt-3">
                                    <div class="form-row">
                                        <label for="shipstreet">Street</label>
                                        <textarea class="form-control" id="shipstreet" name="shipstreet"
                                            style="background-color: #2f516f;color: white;"></textarea>
                                        <div class="invalid-feedback">Please provide a valid Street</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipcity">City</label>
                                        <input type="text" class="form-control" id="shipcity" name="shipcity"
                                            style="background-color: #2f516f;color: white;" placeholder="City">
                                        <div class="invalid-feedback">Please provide a valid City</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipstate">State</label>
                                        <select type="text" class="form-control" id="shipstate" name="shipstate"
                                            style="background-color: #2f516f; color: white;">
                                            <option id="shipst" selected>Choose</option>
                                            <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                                            </option>
                                            <option value="Andhra Predhesh">Andhra Predhesh</option>
                                            <option value="Arunachal Predesh">Arunachal Predesh</option>
                                            <option value="Assam">Assam</option>
                                            <option value="Bihar">Bihar</option>
                                            <option value="Chandigarh">Chandigarh</option>
                                            <option value="Chhattisgarh">Chhattisgarh</option>
                                            <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                                            <option value="Damn anad Diu">Damn anad Diu</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Goa">Goa</option>
                                            <option value="Gujarat">Gujarat</option>
                                            <option value="Haryana">Haryana</option>
                                            <option value="Himachal Predesh">Himachal Predesh</option>
                                            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                            <option value="Jharkhand">Jharkhand</option>
                                            <option value="Karnataka">Karnataka</option>
                                            <option value="Kerala">Kerala</option>
                                            <option value="Ladakh">Ladakh</option>
                                            <option value="Lakshadweep">Lakshadweep</option>
                                            <option value="Madhya Predesh">Madhya Predesh</option>
                                            <option value="Maharashtra">Maharashtra</option>
                                            <option value="Manipur">Manipur</option>
                                            <option value="Meghalaya">Meghalaya</option>
                                            <option value="Mizoram">Mizoram</option>
                                            <option value="Nagaland">Nagaland</option>
                                            <option value="Odisha">Odisha</option>
                                            <option value="Puducherry">Puducherry</option>
                                            <option value="Punjab">Punjab</option>
                                            <option value="Rajasthan">Rajasthan</option>
                                            <option value="Sikkim">Sikkim</option>
                                            <option value="Tamil Nadu">Tamil Nadu</option>
                                            <option value="Telangana">Telangana</option>
                                            <option value="Tripura">Tripura</option>
                                            <option value="Uttar Predesh">Uttar Predesh</option>
                                            <option value="Uttarakhand">Uttarakhand</option>
                                            <option value="West Bengal">West Bengal</option>
                                            <option value="Other Territory">Other Territory</option>
                                        </select>
                                        <div class="invalid-feedback">Please provide a valid State</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shippinco">Pin Code</label>
                                        <input type="text" class="form-control" id="shippinco" name="shippincode"
                                            style="background-color: #2f516f;color: white;" placeholder="PIN code">
                                        <div class="invalid-feedback">Please provide a valid Pin Code</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipcountry">Country</label>
                                        <input type="text" class="form-control" id="shipcountry" name="shipcountry"
                                            style="background-color: #2f516f;color: white;" placeholder="Country">
                                        <div class="invalid-feedback">Please provide a valid Country</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required
                                    style="background-color: #2f516f;">
                                <label>Agree to terms and conditions</label>
                                <div class="invalid-feedback">You must agree before submitting.</div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4"></div>
                        <div class="col-md-4">
                            <button class="btn btn-outline-info rounded-pill text-grey w-100 mt-3 mb-3" type="submit"
                                id="customerSave">
                                Submit form
                            </button>
                        </div>
                        <div class="col-md-4"></div>
                    </div>

                </form>



            </div>

        </div>
    </div>
</div>


<script>

    $(document).on("click", "#customerSave", function () {

        $.ajax({

            type: 'POST',
            url: "{% url 'customers' %}",

            data: {
                csrfmiddlewaretoken: '{{ csrf_token }}',
                title: $('#title').val(),
                firstname: $('#firstname').val(),
                lastname: $('#lastname').val(),
                company: $("#company").val(),
                location: $("#location").val(),
                openbalance: $("#openbalance").val(),
                crd_lmt: $('#crd_lmt').val(),
                email: $("#email1").val(),
                website: $("#website").val(),
                mobile: $("#mobile").val(),
                street: $("#street").val(),
                city: $("#city").val(),
                state: $("#state").val(),
                country: $("#country").val(),
                pincode: $("#pinco").val(),
                shipstreet: $("#shipstreet").val(),
                shipcity: $("#shipcity").val(),
                shipstate: $("#shipstate").val(),
                shipcountry: $("#shipcountry").val(),
                shippincode: $("#shippinco").val(),
                gsttype: $("#gsttype").val(),
                gstin: $("#gstin").val(),
                panno: $("#panno").val(),
                placeof_supply: $("#placeof_supply").val(),
                p_list: $("#p_list").val(),
                pay_term: $("#pay_term").val()


            },

            success: function (response) {
                console.log("success")
                document.getElementById("modalCustomer").reset();
                location.reload();
            },
        });
    });
</script>


<!-- modal item -->
<script>
    function create_item() {


        if (document.getElementsByName('status')[0].checked) {
            var status = document.getElementsByName('status')[0].value;
        } else {
            var status = document.getElementsByName('status')[1].value;
        }
        if (document.getElementsByName('taxref')[0].checked) {
            var taxType = document.getElementsByName('taxref')[0].value;
        } else {
            var taxType = document.getElementsByName('taxref')[1].value;
        }
        var inter_st = document.getElementsByName('inter_st')[0].value
        var intra_st = document.getElementsByName('intra_st')[0].value

        var name = document.getElementsByName('name')[0].value
        var type = document.getElementsByName('type')[0].value
        var unit = document.getElementsByName('unit')[0].value
        var hsn = document.getElementsByName('hsn')[0].value
        var pcost = document.getElementsByName('pcost')[0].value
        var pur_account = document.getElementsByName('pur_account')[0].value
        var pur_desc = document.getElementsByName('pur_desc')[0].value

        var salesprice = document.getElementsByName('salesprice')[0].value
        var sale_account = document.getElementsByName('sale_account')[0].value
        var sale_desc = document.getElementsByName('sale_desc')[0].value

        var invacc = document.getElementsByName('invacc')[0].value
        var stock = document.getElementsByName('stock')[0].value
        console.log('done')

        console.log(name)
        console.log(hsn)
        console.log('done')

        $.ajax({

            type: "GET",
            url: "{% url 'additem_challan' %}",

            data: {
                types: type,
                inters: inter_st,
                intras: intra_st,
                status: status,
                names: name,
                units: unit,
                sel_prices: salesprice,
                sel_accs: sale_account,
                s_descs: sale_desc,
                cost_prices: pcost,
                cost_accs: pur_account,
                p_descs: pur_desc,
                invacc: invacc,
                stock: stock,
                hsn: hsn,
                taxType: taxType,
            },

            success: function (response) {
                console.log(response)

                window.datast = response.names

                document.getElementById("items_nms").innerHTML = window.datast
                const id_country_option = document.getElementById("item2");


            }

        });


    }
</script>
<!-- Latest New item add modal == added -Shemeem -->
<!-- New Item Modal -->

<div class="modal fade" id="newUnitAddModal" data-bs-backdrop="static" aria-hidden="true"
    aria-labelledby="newUnitAddModalLabel" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content" style="background-color: #213b52;">
            <div class="modal-header">
                <h3 class="m-3" id="newUnitAddModalLabel">Unit Create</h3>
                <button type="button" class="close" id="unitmodalclose" data-bs-toggle="modal" data-bs-target="#newitem"
                    aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <div class="card p-3 m-3">
                    <form method="post" autocomplete="off" id="newunitform">
                        {% csrf_token %}
                        <div class="row mt-2 mb-2">
                            <div class="col-md-6">
                                <label for="acctyp">Unit Symbol</label>
                                <input type="text" name="unitsymbol" id="unitsymbol"
                                    class="custom-select-md form-control w-100">
                            </div>
                            <div class="col-md-6">
                                <label for="name">Name</label>
                                <input name="uname" id="unitname" class="custom-select-md form-control w-100">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4"></div>
                            <div class="col-md-4 mt-4 mb-4">
                                <button type="button" id="saveNewUnit" data-bs-dismiss="modal"
                                    class="btn btn-outline-info rounded-pill w-100">Create</button>
                            </div>
                            <div class="col-md-4"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="newitem" aria-hidden="true" aria-labelledby="newItemAddLabel" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable modal-xl">
        <div class="modal-content" style="background-color: #213b52;">
            <div class="modal-header">
                <h3 class="m-3" id="newItemAddLabel">New Item</h3>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card p-3 m-3">
                    <form method="post" autocomplete="off" id="modalItem">
                        {%csrf_token%}
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-12 mx-0">
                                        <div class="row">
                                            <div class="col-md-6 mt-3">
                                                <label for="item_name" style="color: white;">Name</label>
                                                <input type="text" name="name" class="form-control" id="item_name"
                                                    style="background-color: #2a4964; color: white;" autocomplete="off"
                                                    required>
                                            </div>
                                            <div class="col-md-6 mt-3">
                                                <label for="type" style="color: white;">Type</label>
                                                <select name="type" class="form-control" id="type"
                                                    style="background-color: #2a4964; color: white;" required>
                                                    <option selected disabled value="">Choose...</option>
                                                    <option value="goods">Goods</option>
                                                    <option value="services">Services</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="row">
                                                    <div class="col-md-12 mx-0">
                                                        <div class="row">
                                                            <div class="col-md-6 mt-3">
                                                                <label for="unit" style="color: white;">Unit
                                                                </label>
                                                                <div class="d-flex">
                                                                    <select class="custom-select" name="unit"
                                                                        id="itemunit" required
                                                                        style="background-color: #2a4964; color: white;">
                                                                        <option selected disabled value="">Choose...
                                                                        </option>
                                                                        {% for a in unit %}
                                                                        <option style="text-transform:Uppercase;">{{
                                                                            a.unit_symbol}}-{{ a.name }}</option>
                                                                        {% endfor %}
                                                                        <option>BAG-BAGS</option>
                                                                        <option>BAL-BALE</option>
                                                                        <option>BDL-BUNDLES</option>
                                                                        <option>BKL-BUCKLES</option>
                                                                        <option>BOX-BOX</option>
                                                                        <option>BOU-BILLIONS OF UNITS</option>
                                                                        <option>BTL-BOTTLES</option>
                                                                        <option>BUN-BUNCHES</option>
                                                                        <option>CAN-CANS</option>
                                                                        <option>CBM-CUBIC METER</option>
                                                                        <option>CMS-CENTIMETER</option>
                                                                        <option>CCM-CUBIC CENTIMETER</option>
                                                                        <option>CTN-CARTONS</option>
                                                                        <option>DOZ-DOZEN</option>
                                                                        <option>DRM-DRUM</option>
                                                                        <option>GGR-GREAT GROSS</option>
                                                                        <option>GMS-GRAMS</option>
                                                                        <option>GRS-GROSS</option>
                                                                        <option>GYD-GROSS YARDS</option>
                                                                        <option>KGS-KILOGRAMS</option>
                                                                        <option>KLR-KILOLITER</option>
                                                                        <option>KME-KILOMETRE</option>
                                                                        <option>MTS Metric ton</option>
                                                                        <option>MLT-MILLILITRE</option>
                                                                        <option>MTR-METERS</option>
                                                                        <option>NOS-NUMBER</option>
                                                                        <option>PAC-PACKS</option>
                                                                        <option>PCS-PIECES</option>
                                                                        <option>PRS-PAIRS</option>
                                                                        <option>QTL-QUINTAL</option>
                                                                        <option>ROL-ROLLS</option>
                                                                        <option>SQF-SQUARE FEET</option>
                                                                        <option>SET-SETS</option>
                                                                        <option>SQM-SQUARE METERS</option>
                                                                        <option>SQY-SQUARE YARDS</option>
                                                                        <option>TBS-TABLETS</option>
                                                                        <option>TGM-TEN GROSS</option>
                                                                        <option>THD-THOUSANDS</option>
                                                                        <option>TON-TONNES</option>
                                                                        <option>TUB-TUBES</option>
                                                                        <option>UGS-US GALLONS</option>
                                                                        <option>UNT-UNITS</option>
                                                                        <option>YDS-YARDS</option>


                                                                    </select>
                                                                    <!-- <a href="{% url 'add_unit' %}">
                                                                    <button type="button"
                                                                            class="btn btn-outline-secondary ml-1">+
                                                                    </button>
                                                                </a> -->
                                                                    <a class="btn btn-outline-secondary ml-1"
                                                                        data-bs-target="#newUnitAddModal"
                                                                        data-bs-toggle="modal"
                                                                        data-bs-dismiss="modal">+</a>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6 mt-3">
                                                                <label for="hsn" style="color: white;">HSN
                                                                    Code</label>
                                                                <input type="text" name="hsn" class="form-control"
                                                                    id="hsn"
                                                                    style="background-color: #2a4964; color: white;"
                                                                    placeholder="Enter a valid HSN code" required
                                                                    oninput="validateHSNNewItem()">
                                                                <div id="errorText" style="color: red;"></div>
                                                            </div>

                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6 mt-3">

                                                            </div>

                                                        </div>

                                                        <div class="row">
                                                            <div class="col-md-3 mt-3">
                                                                <label for="validationCustom05" name
                                                                    style="color: white;">Tax Reference
                                                                </label>

                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check mt-1">

                                                                    <input class="form-check-input" name="taxref"
                                                                        type="checkbox" id="inclusive" value="taxable">
                                                                    <label style="color: white;"
                                                                        for="inclusive">Taxable</label>

                                                                </div>

                                                            </div>
                                                            <div class="form-check mt-1">
                                                                <input class="form-check-input" name="taxref"
                                                                    type="checkbox" value="non taxable" id="check">
                                                                <label style="color: white;" for="check">Non
                                                                    Taxable</label>
                                                            </div>
                                                        </div>
                                                        <div class="row" id="intrastateFiled" style="display: none;">
                                                            <div class="col-md-6 mt-3">
                                                                <label for="validationCustom05"
                                                                    style="color: white;">Intra State Tax Rate</label>
                                                                <select name="intra_st" class="form-control"
                                                                    style="background-color: #2a4964; color: white;"
                                                                    id="intra_st">

                                                                    <option value=0>GST 0 (0%)</option>
                                                                    <option value=5>GST 5 (5%)</option>
                                                                    <option value=12>GST 12 (12%)</option>
                                                                    <option value=18>GST 18 (18%)</option>
                                                                    <option value=28>GST 28 (28%)</option>

                                                                </select>
                                                                <br>
                                                                <label for="validationCustom05"
                                                                    style="color: white;">Inter State Tax Rate</label>
                                                                <select name="inter_st" class="form-control"
                                                                    style="background-color: #2a4964; color: white;"
                                                                    id="inter_st">

                                                                    <option value=0>IGST 0 (0%)</option>
                                                                    <option value=5>IGST 5 (5%)</option>
                                                                    <option value=12>IGST 12 (12%)</option>
                                                                    <option value=18>IGST 18 (18%)</option>
                                                                    <option value=28>IGST 28 (28%)</option>

                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 mt-3">
                                                        <label for="validationCustom01" style="color: white;">Purchase
                                                            Price</label>
                                                        <div class="row">
                                                            <div>
                                                                <input type="text" class="form-control" value="INR"
                                                                    style="margin-left:20px;width:60px;background-color: #2a4960; color: white;">
                                                            </div>
                                                            <div>
                                                                <input type="number" name="pcost" class="form-control"
                                                                    id="purprice"
                                                                    style="width:540px;background-color: #2a4964; color: white; width:200%"
                                                                    value="0">
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="col-md-6 mt-3">
                                                        <label for="validationCustom01" style="color: white;">Sales
                                                            Price</label>
                                                        <div class="row">
                                                            <div>
                                                                <input type="text" class="form-control" value="INR"
                                                                    style="margin-left:20px;width:60px;background-color: #2a4960; color: white;">
                                                            </div>
                                                            <div>
                                                                <div>
                                                                    <input type="text" name="salesprice"
                                                                        class="form-control" id="saleprice"
                                                                        style="width:540px;background-color: #2a4964; color: white; width:200%"
                                                                        value="0">
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 mx-0">
                                                        <div class="row">
                                                            <div class="col-md-6 mt-3">
                                                                <label for="validationCustom01"
                                                                    style="color: white;">Account</label>
                                                                <select name="pur_account" class="form-control"
                                                                    style="background-color: #2a4964; color: white;"
                                                                    id="pur_account">
                                                                    <option>Cost of Goods Sold</option>
                                                                    {% for a in acc1 %}
                                                                    <option value="{{a.name}}">{{ a.name }}</option>
                                                                    {% endfor %}
                                                                </select>
                                                            </div>
                                                            <div class="col-md-6 mt-3">
                                                                <label for="validationCustom01"
                                                                    style="color: white;">Account</label>
                                                                <select name="sale_account" class="form-control"
                                                                    style="background-color: #2a4964; color: white;"
                                                                    id="sale_account">
                                                                    <option>Sales</option>
                                                                    {% for a in acc2 %}
                                                                    <option value="{{a.name}}">{{ a.name }}</option>
                                                                    {% endfor %}
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 mx-0">
                                                                <div class="row">
                                                                    <div class="col-md-6 mt-3">
                                                                        <label for="validationCustom01"
                                                                            style="color: white;">Description</label>
                                                                        <textarea class="form-control" name="pur_desc"
                                                                            id="pur_desc"
                                                                            style="background-color: #2a4964; color: white;"></textarea>
                                                                    </div>
                                                                    <div class="col-md-6 mt-3">
                                                                        <label for="validationCustom01"
                                                                            style="color: white;">Description</label>
                                                                        <textarea class="form-control" name="sale_desc"
                                                                            id="sale_desc"
                                                                            style="background-color: #2a4964; color: white;"></textarea>
                                                                    </div>
                                                                </div>


                                                                <div class="row">
                                                                    <div class="col-md-12 mx-0">
                                                                        <div class="row mt-3">



                                                                            <div class="col-md-3">
                                                                                <div class="form-check">
                                                                                    <input class="form-check-input"
                                                                                        onclick="ShowHideDiv(this)"
                                                                                        type="checkbox" id="track">
                                                                                    <label class="form-check-label"
                                                                                        for="track">
                                                                                        Track Inventory
                                                                                    </label>
                                                                                </div>

                                                                            </div>

                                                                        </div>

                                                                        <div class="row" id="inventorytrack"
                                                                            style="display: none">
                                                                            <div class="col-md-6 mt-3">
                                                                                <label for="validationCustom01"
                                                                                    style="color: white;">Inventory
                                                                                    Account</label>
                                                                                <select name="invacc"
                                                                                    class="form-control" id="invacc"
                                                                                    style="background-color: #2a4964; color: white;">
                                                                                    <option selected disabled value="">
                                                                                        Choose...</option>
                                                                                    <option value="Inventory Assets">
                                                                                        Inventory Assets</option>

                                                                                </select>
                                                                            </div>
                                                                            <div class="col-md-3 mt-3">
                                                                                <label for="validationCustom01"
                                                                                    style="color: white;">Stock on
                                                                                    hand</label>
                                                                                <input type="number" name="stock"
                                                                                    class="form-control" id="stock"
                                                                                    style="background-color: #2a4964; color: white;"
                                                                                    value="0">
                                                                            </div>
                                                                            <div class="col-md-3 mt-3">
                                                                                <label for="validationCustom01"
                                                                                    style="color: white;">Stock Rate per
                                                                                    Unit</label>
                                                                                <input type="number" name="stock_rate"
                                                                                    class="form-control" id="stock_rate"
                                                                                    style="background-color: #2a4964; color: white;"
                                                                                    value="0">
                                                                            </div>
                                                                        </div>




                                                                        <div class="row">
                                                                            <div class="col-md-6 mt-3">

                                                                            </div>

                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-md-3 mt-3">
                                                                                <label for="validationCustom05" name
                                                                                    style="color: white;">Active/Inactive
                                                                                </label>

                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="form-check">
                                                                                    <input class="form-check-input"
                                                                                        value="Active" type="radio"
                                                                                        name="status"
                                                                                        id="flexRadioDefault1" checked>
                                                                                    <label class="form-check-label"
                                                                                        for="flexRadioDefault1">
                                                                                        Active
                                                                                    </label>
                                                                                </div>

                                                                            </div>
                                                                            <div class="form-check">
                                                                                <input class="form-check-input"
                                                                                    value="Inactive" type="radio"
                                                                                    name="status"
                                                                                    id="flexRadioDefault2">
                                                                                <label class="form-check-label"
                                                                                    for="flexRadioDefault2">
                                                                                    Inactive
                                                                                </label>
                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="row">
                                                                    <div class="col-md-4"></div>
                                                                    <div class="col-md-4">
                                                                        <button
                                                                            class="btn btn-outline-info rounded-pill w-100 text-light"
                                                                            data-bs-dismiss="modal" type="button"
                                                                            id="itemSave">SUBMIT</button>

                                                                        <div class="col-md-4"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- /model -->



<!-- <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script> -->






<script>


    function toggleDateInputss(rowIndex) {
        console.log(rowIndex);
        var checkbox = document.getElementById("plosu");
        var vale = checkbox.value;
        // Find the index of the hyphen
        var index = vale.indexOf("-");
        // Remove the first letters before the hyphen
        var result = vale.substring(index + 1);
        var c_state = "{{cmp1.state}}";

        var taxElement = $('#tax' + rowIndex);

        if (result === c_state) {
            taxElement.find('optgroup[label="GST"]').show();
            taxElement.find('optgroup[label="IGST"]').hide();
            var select = document.getElementById(`tax${rowIndex}`);
            var gstOptgroup = taxElement.find('optgroup[label="GST"]');
            var gstOptions = gstOptgroup.find('option');

            for (var j = 0; j < gstOptions.length; j++) {
                select.selectedIndex = gstOptions[0].index; // Set selectedIndex to the index of the matched option
                break;
            }
            document.getElementById('tr_cgst').style = ('display: flex');
            document.getElementById('tr_sgst').style = ('display: flex');
            document.getElementById('tr_igst').style = ('display: none');
        } else {
            taxElement.find('optgroup[label="GST"]').hide();
            taxElement.find('optgroup[label="IGST"]').show();
            var select = document.getElementById(`tax${rowIndex}`);
            var igstOptgroup = taxElement.find('optgroup[label="IGST"]');
            var igstOptions = igstOptgroup.find('option');
            for (var j = 0; j < igstOptions.length; j++) {
                select.selectedIndex = igstOptions[0].index; // Set selectedIndex to the index of the matched option
                break;
            }
            document.getElementById('tr_cgst').style = ('display: none');
            document.getElementById('tr_sgst').style = ('display: none');
            document.getElementById('tr_igst').style = ('display: flex');


        }
    }

    var tbl = document.querySelectorAll('#item_table tbody tr');
    var tbl_len = tbl.length;
    console.log(tbl_len);

    for (var m = 1; m <= tbl_len; m++) {
        console.log(m);
        // Generate table row
        // ...

        // Call toggleDateInput function for each row
        toggleDateInputss(m);
    }




    function itemfunction(id_str) {
        id = id_str.split("itemsearchInput")[1]

        $itemsearchrows = $(`.dropdown-menu #dd-item${id}`);
        $(`#itemsearchInput${id}`).keyup(function () {
            var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
            $itemsearchrows.show().filter(function () {
                var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                return !~text.indexOf(val);
            }).hide();
        });

        $itemsearchrows.click(function () {
            var select = $(this).val();
            $.ajax({
                type: "GET",
                url: "{% url 'getitems2' %}",
                data: {
                    id: select
                },
                success: function (response) {
                    data = response.hsn
                    data1 = response.desp
                    data2 = response.qty
                    data3 = response.price
                    data4 = response.gst
                    data5 = response.sgst
                    data6 = response.name
                    data7 = response.itemid

                    oxy_gst = data4
                    oxy_igst = data5
                    toggleDateInput(id, oxy_igst, oxy_gst);

                    document.getElementById(`hsn${id}`).value = data;
                    document.getElementById(`qty${id}`).value = 0;
                    document.getElementById(`rate${id}`).value = data3;
                    document.getElementById(`desc${id}`).value = data1;
                    document.getElementById(`discount${id}`).value = 0.00;
                    document.getElementById(`itemsearchInput${id}`).value = data6;
                    document.getElementById(`item${id}`).value = data7;
                    document.getElementById(`taxamount${id}`).value = 0.00;
                    document.getElementById(`amount${id}`).value = 0.00;

                }
            });
        });
    }


    $(document).on('change', '#openbalance', function () {
        openbal = $("#openbalance").val()
        if ($('#bal').val() == 'credit') {
            if (openbal.slice(0, 1) != '-') {
                if (parseFloat(openbal) != 0) {
                    document.getElementById("openbalance").value = "-" + openbal
                } else {
                    document.getElementById("openbalance").value = openbal
                }
            } else {
                if (parseFloat(openbal) != 0) {
                    document.getElementById("openbalance").value = openbal
                } else {
                    document.getElementById("openbalance").value = -1 * parseFloat(openbal)
                }
            }
        } else {
            document.getElementById("openbalance").value = openbal
        }
    });

    $(document).on('change', '#bal', function () {
        openbal = $("#openbalance").val()
        if (openbal != "") {
            if ($('#bal').val() == 'credit') {
                openbal = $("#openbalance").val()
                if (parseFloat(openbal) != 0) {
                    document.getElementById("openbalance").value = "-" + openbal
                } else {
                    document.getElementById("openbalance").value = openbal
                }
            } else {
                openbal = $("#openbalance").val()
                document.getElementById("openbalance").value = -1 * (parseFloat(openbal))
            }
        }
    });

    function toggleDateInput(rowIndex) {
        var checkbox = document.getElementById("plosu");
        var vale = checkbox.value;
        // Find the index of the hyphen
        var index = vale.indexOf("-");
        // Remove the first letters before the hyphen
        var result = vale.substring(index + 1);
        var c_state = '{{cmp1.state}}';
        var gst = oxy_gst;
        var igst = oxy_igst;

        var taxElement = $('#tax' + rowIndex);
        tax_value = $('#tax' + rowIndex).val();
        var labelElement = $('#ml' + rowIndex);


        if (result === c_state) {
            taxElement.find('optgroup[label="GST"]').show();
            taxElement.find('optgroup[label="IGST"]').hide();
            var select = document.getElementById(`tax${rowIndex}`);
            var gstOptgroup = taxElement.find('optgroup[label="GST"]');
            var gstOptions = gstOptgroup.find('option');


            for (var j = 0; j < gstOptions.length; j++) {
                if (gstOptions[j].value === gst) {
                    select.selectedIndex = gstOptions[j].index; // Set selectedIndex to the index of the matched option
                    // Add event listener for the change event

                    break;
                }
            }

            document.getElementById('tr_cgst').style = ('display: flex');
            document.getElementById('tr_sgst').style = ('display: flex');
            document.getElementById('tr_igst').style = ('display: none');

        } else {
            taxElement.find('optgroup[label="GST"]').hide();
            taxElement.find('optgroup[label="IGST"]').show();
            var select = document.getElementById(`tax${rowIndex}`);
            var igstOptgroup = taxElement.find('optgroup[label="IGST"]');
            var igstOptions = igstOptgroup.find('option');

            for (var j = 0; j < igstOptions.length; j++) {
                if (igstOptions[j].value === igst) {
                    select.selectedIndex = igstOptions[j].index; // Set selectedIndex to the index of the matched option
                    // Add event listener for the change event

                    break;
                }

            }
            document.getElementById('tr_cgst').style = ('display: none');
            document.getElementById('tr_sgst').style = ('display: none');
            document.getElementById('tr_igst').style = ('display: flex');


        }

    }
    var checkbox = document.getElementById("plosu");
    checkbox.addEventListener('change', function () {

        for (var i = 1; i <= RowCount; i++) {
            toggleDateInput(i);
        }
    });

    for (var i = 1; i <= RowCount; i++) {
        // Generate table row
        // ...

        // Call toggleDateInput function for each row
        toggleDateInput(i);
    }

    $(document).ready(function () {

        for (var i = 1; i <= RowCount; i++) {
            // Generate table row
            // ...

            // Call toggleDateInput function for each row
            toggleDateInput(i);
        }
    });


</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    function poppins() {
        var chkbtn = document.getElementById('okay');
        if (chkbtn.checked == true) {
            document.getElementById('shipstreet').value = document.getElementById('street').value;
            document.getElementById('shipcity').value = document.getElementById('city').value;
            document.getElementById('shippinco').value = document.getElementById('pinco').value;
            document.getElementById('shipcountry').value = document.getElementById('country').value;
            document.getElementById('shipst').value = document.getElementById('state').value;
            document.getElementById('shipst').innerHTML = document.getElementById('state').value;
        } else {
            document.getElementById('shipstreet').value = '';
            document.getElementById('shipcity').value = '';
            document.getElementById('shipstate').value = '';
            document.getElementById('shippinco').value = '';
            document.getElementById('shipcountry').value = '';
        }
    }
</script>
<script>
    function hidinput(divId, element) {

        if (element.value == 'unregistered Business' || element.value == 'Consumer' || element.value == 'Overseas' | element.value == '') {
            document.getElementById(divId).style.display = 'none';
        } else {
            document.getElementById(divId).style.display = 'block';
        }
    }






    function checkgst(element) {
        var gstinput = element.value;
        var gstregexp = "[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}";
        if (gstinput.match(gstregexp)) {
            document.getElementById('warngst').innerHTML = '';
        } else {
            document.getElementById('warngst').innerHTML = 'Please provide a valid GST Number';
            alert('Please provide a valid GST Number');
        }
    }

    function validateEmail(element) {
        var emailinput = element.value;
        var emailregexp = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;

        if (emailinput.match(emailregexp)) {
            document.getElementById('warneamil').innerHTML = '';
        } else {
            document.getElementById('warneamil').innerHTML = 'Please provide a valid Email';
            alert('Please provide a valid Email');
        }
    }

    function checkpan(element) {
        var paninput = element.value;
        var panregexp = ["[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}"]
        if (paninput.match(panregexp)) {
            document.getElementById('warnpan').innerHTML = '';
        } else {
            document.getElementById('warnpan').innerHTML = 'Please provide a valid PAN Number';
            alert('Please provide a valid PAN Number')
        }
    }

    function checkweb(element) {
        var webinput = element.value;
        var webregexp = "www."
        if (webinput.startsWith(webregexp)) {
            document.getElementById('warnweb').innerHTML = '';
        } else {
            document.getElementById('warnweb').innerHTML = 'Please provide a valid Website Address';
            alert('Please provide a valid Website Address')
        }
    }

    function checkphone(element) {
        var phoneinput = element.value;
        var phoneregexp = "[0-9]{10}";
        if (phoneinput.match(phoneregexp)) {
            document.getElementById('warnphone').innerHTML = '';
        } else {
            document.getElementById('warnphone').innerHTML = 'Please provide a valid Phone Number';
            alert('Please provide a valid Phone Number')
        }
    }
</script>

<script src="{% static 'assets/plugins/select2/js/select2.min.js' %}"></script>

<script>
    function insertValue() {
        var select = document.getElementById("select"),
            txtVal = document.getElementById("val").value,
            newOption = document.createElement("OPTION"),
            newOptionval = document.createTextNode(txtVal);

        newOption.appendChild(newOptionval);
        select.insertBefore(newOption, select.lastChild);
    }
</script>
<script>
    $('.datepicker').pickadate({
        selectMonths: true,
        selectYears: true
    }),
        $('.timepicker').pickatime()
</script>
<script>
    $(function () {
        $('#date-time').bootstrapMaterialDatePicker({
            format: 'YYYY-MM-DD HH:mm'
        });
        $('#date').bootstrapMaterialDatePicker({
            time: false
        });
        $('#time').bootstrapMaterialDatePicker({
            date: false,
            format: 'HH:mm'
        });
    });
</script>
<script type="text/javascript">
    $(document).ready(function () {

        var current_fs, next_fs, previous_fs; //fieldsets
        var opacity;

        $(".next").click(function () {

            current_fs = $(this).parent();
            next_fs = $(this).parent().next();

            //Add Class Active
            $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

            //show the next fieldset
            next_fs.show();
            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    next_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });

        $(".previous").click(function () {

            current_fs = $(this).parent();
            previous_fs = $(this).parent().prev();

            //Remove class active
            $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

            //show the previous fieldset
            previous_fs.show();

            //hide the current fieldset with style
            current_fs.animate({ opacity: 0 }, {
                step: function (now) {
                    // for making fielset appear animation
                    opacity = 1 - now;

                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    previous_fs.css({ 'opacity': opacity });
                },
                duration: 600
            });
        });

        $('.radio-group .radio').click(function () {
            $(this).parent().find('.radio').removeClass('selected');
            $(this).addClass('selected');
        });



    });

</script>
<script type="text/javascript">
    function ShowHideDiv(track) {
        var inventorytrack = document.getElementById("inventorytrack");

        inventorytrack.style.display = track.checked ? "flex" : "none";

    }
    $('#inclusive').on('click', function () {
        if (document.getElementById('inclusive').checked) {
            document.getElementById("intrastateFiled").style.display = 'block';
        } else {
            document.getElementById("intrastateFiled").style.display = 'none';
        }
    })
    // function ShowHideTax(inclusive) {
    //         var inter = document.getElementById("intrastateFiled");

    //         inter.style.display = inclusive.checked ? "block" : "none";

    //     }
</script>


<script>
    function validateForm() {
        let x = document.forms["myForm"]["fname"].value;
        if (x == "") {
            alert("Name must be filled out");
            return false;
        }
    }
</script>



{% endblock %}